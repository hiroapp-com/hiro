<html style="overflow: hidden;">
<head>
	<script>var _wpc=window.parent.WPCLib,$=window.parent.$,analytics=window.parent.analytics;</script>
    {{ get_asset('hiro_css') }}				
	<script type="text/javascript" src="//use.typekit.net/nmo5dsg.js"></script>    
	<script type="text/javascript">try{Typekit.load();}catch(e){}</script>		
</head>
<body id="settingsPage">
	<a href="#" onclick="_wpc.ui.hideDialog();return false;" ontouchstart="_wpc.ui.hideDialog();return false;" class="close">Close</a>
	<div>
        {% if not current_user.is_authenticated() %}
		<div id="s_login">
			<div id="s_signup" style="display:none;">
				<a href="#" class="fb wpcbutton" onclick="this.innerHTML='Signing Up...';facebooklogin();return false;">Sign-In With&nbsp;<b>Facebook</b></a>
				<div class="divider"><span class="or">or</span></div>
				<form id="signupform" action="javascript:void(0);">
					<input type="text" placeholder="E-Mail" onblur="document.getElementById('signin_mail').value=this.value;" id="signup_mail" onkeydown="this.nextSibling.innerHTML='';"></input><div class="error"></div>					
					<input type="password" placeholder="Choose a password" onkeydown="this.nextSibling.innerHTML='';"></input><div class="error"></div>	
					<input type="submit" value="foo" onclick="_wpc.sys.user.register(event); return false;" class="pseudobutton"></input>
				</form>		
				<a class="wpcbutton green" id="signupbutton" onclick="_wpc.sys.user.register(event);">Create Account</a>	
				<div id="signuperror"></div>
				<a class="small" onclick="_wpc.ui.switchView(document.getElementById('s_signin'));">Already have an account?</a>			
			</div>	
			<div id="s_signin" style="display:none;">
				<a href="#" class="fb wpcbutton" onclick="this.innerHTML='Signing In...';facebooklogin();return false;">Log-In With&nbsp;<b>Facebook</b></a>
				<div class="divider"><span class="or">or</span></div>
				<form id="loginform" action="javascript:void(0);">
					<input type="text" placeholder="E-Mail" onblur="document.getElementById('signup_mail').value=this.value;" id="signin_mail" onkeydown="this.nextSibling.innerHTML='';"></input><div class="error"></div>
					<input type="password" placeholder="Password" onkeydown="this.nextSibling.innerHTML='';"></input><div class="error"></div>
					<input type="submit" value="foo" onclick="_wpc.sys.user.login(event);" class="pseudobutton"></input>
				</form>		
				<a class="wpcbutton green" id="loginbutton" onclick="_wpc.sys.user.login(event);">Log-In</a>	
				<div id="loginerror"></div>				
				<a class="small" onclick="_wpc.sys.user.requestreset();">Lost password?</a> &nbsp; <a hclass="small" onclick="_wpc.ui.switchView(document.getElementById('s_signup'));">Create an account</a>
			</div>	
			<div id="s_reset" style="display:none;">
				<form id="resetform">
					<input type="password" placeholder="New password" onkeydown="this.nextSibling.innerHTML='';" id="new_password"></input><div class="error"></div>
					<input type="password" placeholder="Repeat password" onkeydown="this.nextSibling.innerHTML='';"></input><div class="error"></div>
					<input type="submit" value="foo" onclick="_wpc.sys.user.resetpwd(); return false;" class="pseudobutton"></input>
				</form>		
				<a href="" class="wpcbutton green" id="resetbutton" onclick="_wpc.sys.user.resetpwd(); return false;">Reset Password</a>	
				<div id="reseterror"></div>	
				<a href="#" class="small" onclick="_wpc.ui.switchView(document.getElementById('s_signin')); return false;">Login with old password.</a>								
			</div>			
		</div>	

		<script type="text/javascript">
		function facebooklogin() {
			var WPFBbuttonHTML = 'Sign-In With <b>Facebook</b>';
			FB.getLoginStatus(function(response) {	
			  if (response.status === 'connected') {
				$.ajax({
					url: "/_cb/facebook",
	                type: "POST",
	                contentType: "application/json; charset=UTF-8",
	                data: JSON.stringify(response.authResponse),
					success: function(data) {
	                    // All that needs to be done at this point
	                    _wpc.sys.user.authed('login',data);									                    
					}
				});				    
			  } else if (response.status === 'not_authorized') {
			    if (window.navigator.standalone) {
			    	// On mobile devices with potentially no popups we do a classic flow
			    	window.parent.location = '/connect/facebook?next=/';
			    } else {
					FB.login(function(response) {
					   if (response.authResponse) {
							$.ajax({
								url: "/_cb/facebook",
				                type: "POST",
				                contentType: "application/json; charset=UTF-8",
				                data: JSON.stringify(response.authResponse),
								success: function(data) {
				                    // All that needs to be done at this point
				                    _wpc.sys.user.authed('register',data,'Facebook');									                    
								}
							});
					   } else {
					   	 // FB auth process aborted by user
					     $("#dialog").contents().find(".fb.wpcbutton").html(WPFBbuttonHTML);
					   }
					},{scope: 'email'});
				}	
			  } else {
			  	// User not signed in to Facebook, so on touch devices we use redirect the window and otehrwise open a popup
			    if (window.navigator.standalone) {
			    	// On mobile devices with potentially no popups we do a classic flow
			    	window.parent.location = '/connect/facebook?next=/';
			    } else {
					FB.login(function(response) {
					   if (response.authResponse) {
							$.ajax({
								url: "/_cb/facebook",
				                type: "POST",
				                contentType: "application/json; charset=UTF-8",
				                data: JSON.stringify(response.authResponse),
								success: function(data) {
				                    // All that needs to be done at this point
				                    _wpc.sys.user.authed('login',data);									                    
								}
							});
					   } else {
					   	 // FB auth process aborted by user
					     $("#dialog").contents().find(".fb.wpcbutton").html(WPFBbuttonHTML);
					   }
					},{scope: 'email'});
				}			
			  }
			});
		}
		</script>
        {% endif %}

		<div id="s_settings" {% if not current_user.is_authenticated() %}style="display:none;"{% endif %}>

			<div id="s_account">
				<div class="header">
					<div class="active">You<em>r Account</em></div>
					<a href="#" onmousedown="_wpc.ui.switchView(document.getElementById('s_plan'));return false;" ontouchstart="_wpc.ui.switchView(document.getElementById('s_plan'));return false;">Plan<em>s &amp; Payment</em></a>
					<a href="#" onmousedown="_wpc.ui.switchView(document.getElementById('s_about'));return false;" ontouchstart="_wpc.ui.switchView(document.getElementById('s_about'));return false;">About</a>	
				</div>
				{% if current_user.is_authenticated() %}
				<div class="accountdetails">
					<form>
						<input type="text" value="{{ current_user.email }}" disabled></input>{% if current_user.facebook_uid %}<div class="ioption">via&nbsp;<a href="https://www.facebook.com/{{ current_user.facebook_uid }}" class="facebook" target="_blank">Facebook</a></div>{% endif %}
						<input type="text" value="Member since:&nbsp;{{ current_user.signup_at.strftime('%B %d, %Y') }}" disabled></input><div class="ioption nomobile">Thanks!</div>
						<input type="text" value="{% if current_user.tier==1 %}Basic{% elif current_user.tier==2 %}Advanced{% else %}Pro{% endif %}&nbsp;Plan" disabled></input><div class="ioption"><a href="#" onclick="_wpc.ui.switchView(document.getElementById('s_plan'));return false;">Upgrade</a></div>			
					</form>		
					<div class="divider"><span class="or">Tell friends about Hiro:</span></div>
					<a href="https://www.facebook.com/dialog/feed?app_id={{ config.FACEBOOK_APP_ID }}&link=https%3A%2F%2Fwww.hiroapp.com&redirect_uri=https%3A%2F%2Fwww.hiroapp.com" class="wpcbutton share fb" onclick="_wpc.ui.facebookshare(); return false;">via&nbsp;<b>Facebook</b></a>
					<a href="https://twitter.com/intent/tweet?text=A%20safe%20place%20for%20your%20ideas%20%23hiro%20%23notetaking%20%23app%20https%3A%2F%2Fwww.hiroapp.com" onclick="window.open(this.href,'twitter','height=282,width=600');if (analytics) window.parent.analytics.track('Shares App',{channel:'Twitter'});return false;" class="wpcbutton share tw">via&nbsp;<b>Twitter</b></a>	
					<a href="mailto:?subject=You%20Know%20Hiro%3F&body=Neat%20little%20app%20for%20daily%20note-taking%3A%20www.hiroapp.com" class="wpcbutton share mail green" onclick="if (analytics) window.parent.analytics.track('Shares App',{channel:'Mail'});" target="_blank">via&nbsp;<b>Mail</b></a>	
					<a href="sms://?body=Hey%2C%20do%20you%20know%20www.hiroapp.com%3F" onclick="if (analytics) window.parent.analytics.track('Shares App',{channel:'SMS'});" class="wpcbutton share sms">via&nbsp;<b>SMS</b></a>
				</div>	
				{% endif %}					
			</div>
				
			<div id="s_plan" style="display:none;">
				<div class="header forced"></div>				
				<div class="header">
					<a href="#" onmousedown="_wpc.ui.switchView(document.getElementById('s_account'));return false;" ontouchstart="_wpc.ui.switchView(document.getElementById('s_account'));return false;">You<em>r Account</em></a>
					<div class="active">Plan<em>s &amp; Payment</em></div>
					<a href="#" onmousedown="_wpc.ui.switchView(document.getElementById('s_about'));return false;" ontouchstart="_wpc.ui.switchView(document.getElementById('s_about'));return false;">About</a>		
				</div>
				<div class="plans" id="s_planboxes">
					<div class="box 1" onclick="_wpc.ui.upgradeboxclick(this);">
						<div class="head">Basic</div>
						<div class="price">Free!</div>
						<div class="curr">&nbsp;</div>	
						<ul>
							<li>Fine for daily usage
							<li>Encrypted like all plans							
							<li>Up to 10 notes
							<li>100 context searches	
						</ul>
						<a href="#" class="wpcbutton grey" onclick="_wpc.ui.hideDialog();return false;">Your Current Plan</a>		
						<a href="#" class="wpcbutton red" onclick="_wpc.sys.user.downgrade('free');return false;">Downgrade</a>	
					</div>
					<div class="box 2" onclick="_wpc.ui.upgradeboxclick(this);">
						<div class="head">Advanced</div>
						<div class="price">9</div>	
						<div class="curr">USD / MONTH</div>	
						<ul>
							<li>Unlimited notes
							<li>Unlimited searches
							<li>Advanced publishing	
							<li>Archive	
						</ul>
						<a href="#" class="wpcbutton grey" onclick="_wpc.ui.hideDialog();return false;">Your Current Plan</a>		
						<a href="#" class="wpcbutton red" onclick="_wpc.sys.user.downgrade('starter');return false;">Downgrade</a>	
						<a href="#" class="wpcbutton green" onclick="_wpc.ui.fillcheckout('starter');return false;">Upgrade !</a>	
					</div>
					<div class="box 3" onclick="_wpc.ui.upgradeboxclick(this);">
						<div class="head">Pro (coming soon)</div>
						<div class="price">29</div>		
						<div class="curr">USD / MONTH</div>	
						<ul>
							<li>All Advanced features
							<li>Speciality data sources
							<li>Pro publishing								
							<li>Chrome research plugin							
						</ul>
						<a href="#" class="wpcbutton grey" onclick="_wpc.ui.hideDialog();return false;">Your Current Plan</a>		
						<a href="#" class="wpcbutton green" onclick="_wpc.ui.fillcheckout('pro');return false;">Preorder !</a>	
					</div>
				</div>	
				<div id="s_planfooter" class="footer">
					<a href="#" onclick="_wpc.ui.hideDialog();return false;">Not now, thanks.</a>	
				</div>	
			</div>

			<div id="s_checkout" style="display:none;">
				<div class="header forced"></div>				
				<div class="header">
					<a href="#" onmousedown="_wpc.ui.switchView(document.getElementById('s_account'));return false;" ontouchstart="_wpc.ui.switchView(document.getElementById('s_account'));return false;">You<em>r Account</em></a>
					<div class="active">Plan<em>s &amp; Payment</em></div>
					<a href="#" onmousedown="_wpc.ui.switchView(document.getElementById('s_about'));return false;" ontouchstart="_wpc.ui.switchView(document.getElementById('s_about'));return false;">About</a>		
				</div>
				<div class="checkoutdetails">	
					{% if current_user.active_cc %}
						<form id="checkoutform">
							<input type="text" value="Advanced Plan for 9" disabled id="cc_desc"></input><div class="ioption changeplan"><a href="#" onclick="_wpc.ui.switchView(document.getElementById('s_plan'));document.activeElement.blur();return false;">Change</a></div>
							<input type="text" disabled value="" placeholder="Credit Card Number" id="cc_number" data-stripe="number" onfocus="this.nextSibling.innerHTML='';"></input><div class="ioption"></div>
							<input type="text" disabled value="" placeholder="Month" id="cc_exp_month" class="small" title="Expiration Month" data-stripe="exp-month" onfocus="document.getElementById('checkout_error').innerHTML=''"></input>&nbsp;/&nbsp;<input type="text" disabled  value="" placeholder="Year" id="cc_exp_year" class="small" title="Expiration Year" data-stripe="exp-year" onfocus="document.getElementById('checkout_error').innerHTML=''"></input>	
							<input type="text" disabled value="" placeholder="CVC" id="cc_cvc" class="small cvc" title="The 3 digits on the back of your card" data-stripe="cvc" onfocus="document.getElementById('checkout_error').innerHTML=''"></input>	
							<div class="small" id="checkout_error"></div>			
							<a href="#" class="wpcbutton green" id="checkoutbutton" onclick="_wpc.sys.user.checkout(); return false;">
							Upgrade</a>	
							<div class="pbstripe"><span class="right">Switch or cancel plans anytime</span>Secure payment powered by&nbsp;<b>stripe</b></div>
							<input type="submit" value="foo" onclick="_wpc.sys.user.checkout(); return false;" class="pseudobutton"></input>
						</form>						
						<script type="text/javascript">
							{% with cc = current_user.active_cc %}
							var hirostripecard = {
								cc_number: "{{ cc['type'] }}: " + '•••• •••• •••• ' + "{{ cc['last4'] }}",
								cc_exp_month: "{{ cc['exp_month'] }}",
								cc_exp_year: "{{ cc['exp_year'] }}",
								cc_cvc: '•••'
							};
							{% endwith %}
							var usehirostripecard = true;
							function fillccform() {
								for (var key in hirostripecard) {
								   if (hirostripecard.hasOwnProperty(key)) {
								   	var el = document.getElementById(key); 
								   	el.value = hirostripecard[key];
								   	if (key=='cc_number') el.addEventListener('click', clearccform(el));
								   }
								}
							}
							var clearccform = function(el) {
							    var handler = function(event) {
							    	var fields = el.parentNode.getElementsByTagName('input');
							    	for (i=0,l=fields.length;i<l;i++) {
							    		if (i>0) fields[i].value = '';
							    	}
							    	usehirostripecard = false;
				           			el.removeEventListener('click', handler);
							    };
							    return handler;
							};
							fillccform();						
						</script>
					{% else %}	
					<form id="checkoutform">
						<input type="text" value="Advanced Plan for 9" disabled id="cc_desc"></input><div class="ioption changeplan"><a href="#" onclick="_wpc.ui.switchView(document.getElementById('s_plan'));document.activeElement.blur();return false;">Change</a></div>
						<input type="text" value="" placeholder="Credit Card Number" id="cc_number" data-stripe="number" onfocus="this.nextSibling.innerHTML='';"></input><div class="ioption"></div>
						<input type="text" value="" placeholder="Month" id="cc_exp_month" class="small" title="Expiration Month" data-stripe="exp-month" onfocus="document.getElementById('checkout_error').innerHTML=''"></input> /
						<input type="text" value="" placeholder="Year" id="cc_exp_year" class="small" title="Expiration Year" data-stripe="exp-year" onfocus="document.getElementById('checkout_error').innerHTML=''"></input>	
						<input type="text" value="" placeholder="CVC" id="cc_cvc" class="small cvc" title="The 3 digits on the back of your card" data-stripe="cvc" onfocus="document.getElementById('checkout_error').innerHTML=''"></input>	
						<div class="small" id="checkout_error"></div>			
						<a href="#" class="wpcbutton green" id="checkoutbutton" onclick="_wpc.sys.user.checkout(); return false;">
						Upgrade</a>	
						<div class="pbstripe"><span class="right">Switch or cancel plans anytime</span>Secure payments powered by&nbsp;<b>stripe</b></div>						
						<input type="submit" value="foo" onclick="_wpc.sys.user.checkout(); return false;" class="pseudobutton"></input>
					</form>						
					{% endif %}
				</div>	
			</div>

			<div id="s_about" style="display:none;">
				<div class="header">
					<a href="#" onmousedown="_wpc.ui.switchView(document.getElementById('s_account'));return false;" ontouchstart="_wpc.ui.switchView(document.getElementById('s_account'));return false;">You<em>r Account</em></a>
					<a href="#" onmousedown="_wpc.ui.switchView(document.getElementById('s_plan'));return false;" ontouchstart="_wpc.ui.switchView(document.getElementById('s_plan'));return false;">Plan<em>s &amp; Payment</em></a>
					<div class="active">About</div>	
				</div>

				<div class="aboutsection">
					<div class="claim"><em>Hiro is for people with big ideas</em><br />
					who want a better tool to keep them.</div>

					Why do we still have so many textfiles on our desktop, or send emails to ourselves? Sure, there are plenty of apps to write longer texts, create colorful scrapbooks or intricate mindmaps. But we wanted something incredibly simple, fast, that works on any device, without complicated syncing through third party services or 3 menus before you can do something. Something you open when a thought you don't want to lose crosses your mind. A place where they are <em>safe and not accessed by anybody else</em>.<br /><br />

					<span class="contact">We hope you like Hiro as much as we do. We're always there at <a href="mailto:hello@hiroapp.com" target="_blank">hello@hiroapp.com</a> and share the best tricks of how people manage their ideas on <a href="https://www.facebook.com/hiroapp" target="_new">facebook.com/hiroapp</a>.</span>
				</div>	
			</div>

		</div>	
	</div>
	<script type="text/javascript" src="https://js.stripe.com/v2/"></script>
	<script type="text/javascript">
		// Set stripe key
  		Stripe.setPublishableKey('{{ config.STRIPE_PUBLIC_KEY }}');
  		// Various startup functions
  		_wpc.ui.setplans();
  		_wpc.lib.init();
  		{% if current_user.is_authenticated() %}
  			var _wpcsiou = {
			    email            : '{{ current_user.email }}',
			    subscriptionPlan : '{{ current_user.plan }}',
			    created: {{ current_user.signup_at_ts }} 
			};
			if (window.navigator.standalone) _wpcsiou.mobileappinstalled = true;
			if ('ontouchstart' in document.documentElement) _wpcsiou.touchdevice = true;
			if (_wpc.sys.user.doccount > 0) _wpcsiou.doccount = _wpc.sys.user.doccount;		
	  		// init segment io
			analytics.identify('{{ current_user.token }}', _wpcsiou);  
			_wpc.sys.user.id = '{{ current_user.token }}';
		{% endif %}			
	</script>
</body>
</html>	
